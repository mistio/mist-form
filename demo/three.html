<!DOCTYPE html>
<html lang="en-US">
<body>
  <div id="demo"></div>
  <script type="module">
    import { html, render } from 'lit-html';
    import '@polymer/iron-ajax/iron-ajax.js';
    import '../../mist-form.js';

    const jsonSchema = {
        "title": "Three questions",
        "description": "Must answer me these questions three, 'ere the other side he see.",
        "type": "object",
        "required": [
          "name",
          "quest",
          "color",
          "velocity",
          "origin"
        ],
        "properties": {
          "name": {
            "type": "string",
            "title": "What is your name?"
          },
          "quest": {
            "type": "string",
            "title": "What is your quest?"
          },
          "color": {
            "type": "string",
            "title": "What is your favorite color?"
          },
          "velocity": {
              "type": "number",
              "title": "What is the air-speed velocity of an unladen swallow?",
              "minimum": 2,
              "maximum": 20
          },
          "origin": {
              "type": "string",
              "title": "Specify the swallow's origin",
              "enum": ["Africa", "Europe"]
          }
        }
      };
    const uiSchema = {
      "quest": {
        "ui:widget": "textarea"
      },
      "color": {
        "ui:widget": "color"
      },
      "velocity": {
        "ui:controls": true,
        "ui:suffix": "knots",
        "ui:options": {
            "style": "min-width: 350px;"
        }
      },
      "ui:submit": "Enter"
    };
    const formData = {
      "name": "Sir Lancelot of Camelot",
      "quest": "To seek the Holy Grail",
      "color": "blue"
    };
    let submitUrl='/api/v1/three';
    
    render(
      html`<mist-form .jsonSchema=${jsonSchema} .uiSchema=${uiSchema} .formData=${formData}>
        <iron-ajax
          slot="formRequest"
          id="formAjax"
          method="POST"
          handle-as="json"
          .url="${submitUrl}"
          .contentType="application/json"
          .submit=${this}
          @mist-form-request=${function (e) {
            this.body = JSON.stringify(e.detail.payload);
            this.generateRequest();
          }}
          @response=${() => {
            console.log('on response');
          }}
          @request=${() => {
            console.log('on request');
          }}
          @error=${() => {
            console.log('on error');
          }}
        ></iron-ajax>
      </mist-form> `,
      document.querySelector('#demo')
    );
  </script>
</body>
</html>